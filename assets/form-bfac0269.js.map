{"version":3,"file":"form-bfac0269.js","sources":["../../src/form.js"],"sourcesContent":["// Opisany w dokumentacji\nimport iziToast from 'izitoast';\n// Opcjonalny import stylÃ³w\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.input');\nconst galleryList = document.querySelector('.gallery-list');\nconst result = document.querySelector('.result');\nconst moreButton = document.querySelector('.more-btn');\nconst BASE_URL = 'https://pixabay.com/api/';\nconst API_KEY = '45116673-24298b0cd3e8b5c60e15e7e67';\n\nconst createToggle = selector => ({\n  enable: () => document.querySelector(selector).classList.remove('disabled'),\n  disable: () => document.querySelector(selector).classList.add('disabled'),\n});\n\nconst loader = createToggle('.text');\nconst loadText = createToggle('.loading-text');\nconst resultText = createToggle('.result-text');\nconst moreBtn = createToggle('.more-btn');\n\nlet currentPage = 1;\nlet totalHits = 0;\nlet per_page = 30;\nlet currentQuery = '';\n\nform.addEventListener('submit', event => {\n  event.preventDefault();\n  currentQuery = input.value.trim();\n  if (currentQuery === '' || input.value === ' ') {\n    iziToast.warning({\n      message: 'Please enter a search term.',\n      position: 'topRight',\n      backgroundColor: '#ef4040',\n      messageColor: '#fff',\n    });\n    return;\n  }\n  currentQuery = input.value;\n  currentPage = 1;\n  fetchImages(currentQuery, currentPage);\n  result.textContent = currentQuery;\n});\n\nmoreButton.addEventListener('click', () => {\n  currentPage += 1;\n  fetchImages(currentQuery, currentPage);\n  result.textContent = currentQuery;\n});\n\nasync function fetchImages(currentQuery, page) {\n  loader.enable();\n  loadText.enable();\n  if (page === 1) {\n    galleryList.innerHTML = '';\n  }\n  try {\n    const response = await axios.get(BASE_URL, {\n      params: {\n        key: '45116673-24298b0cd3e8b5c60e15e7e67',\n        q: currentQuery,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page,\n      },\n    });\n\n    const totalPages = Math.ceil(response.data.totalHits / per_page);\n    if (response.data.hits) {\n      totalHits = response.data.totalHits;\n      displayImages(response.data.hits);\n      loader.disable();\n      loadText.disable();\n      resultText.enable();\n\n      currentPage = page;\n    } else if (page > totalPages) {\n      moreBtn.disable();\n      loadText.disable();\n      loader.disable();\n      iziToast.warning({\n        position: 'topRight',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    } else {\n      moreBtn.disable();\n      iziToast.warning({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: '#ef4040',\n        messageColor: '#fff',\n      });\n    }\n    return response.data;\n  } catch (error) {\n    loader.disable();\n    loadText.disable();\n    moreBtn.disable();\n    console.error(error);\n    iziToast.warning({\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    throw error;\n  }\n}\n\nconst message =\n  'Sorry, there are no images matching your search query. Please try again!';\n\nfunction displayImages(images, page) {\n  if (page === 1) {\n    galleryList.innerHTML = '';\n  }\n  if (totalHits > images.length) {\n    moreBtn.enable();\n  }\n  if (images.length === 0) {\n    loader.disable();\n    loadText.disable();\n    resultText.disable();\n    moreBtn.disable();\n\n    iziToast.warning({\n      message: message,\n      backgroundColor: '#ef4040',\n      messageColor: `#fff`,\n      position: 'topRight',\n      timeout: 2000,\n    });\n    setTimeout(clearValue, 2000);\n\n    return;\n  }\n  const imagesMarkup = images.map(makeImgItem).join('');\n  galleryList.insertAdjacentHTML('beforeend', imagesMarkup);\n  setTimeout(clearValue, 500);\n\n  //   galleryList.appendChild(moreButton);\n\n  lightbox.refresh();\n}\n\nfunction clearValue() {\n  input.value = '';\n}\n\nconst lightbox = new SimpleLightbox('.gallery-list a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n  close: true,\n  className: 'simpleLightboxGallery',\n  doubleTapZoom: 2,\n  scrollZoom: true,\n  overlay: true,\n});\n\nfunction makeImgItem({\n  webformatURL,\n  tags,\n  downloads,\n  likes,\n  comments,\n  views,\n}) {\n  return `<li class=\"list-container\">\n    <div >\n      <div class=\"image-container\">\n        <a href=\"${webformatURL}\" data-source=\"${webformatURL}\">\n          <img src=\"${webformatURL}\" alt=\"${tags}\" />\n        </a>\n      </div>\n      <div class=\"descr-element\">\n        <ul class=\"descr-list\">\n          <li>\n            <h3>Likes</h3>\n              <p>${likes}</p>\n          </li>\n          <li>\n            <h3>Views</h3>\n              <p>${views}</p>\n          </li>\n          <li>\n            <h3>Comments</h3>\n            <p>${comments}</p>\n          </li>\n          <li>\n            <h3>Downloads</h3>\n              <p>${downloads}</p>\n          </li>\n        </ul>\n      </div>\n    </div>\n  </li>`;\n}\n\nconst galleryItemHeight = document\n  .querySelector('.gallery-list')\n  .getBoundingClientRect().height;\nwindow.scrollBy({\n  top: galleryItemHeight * 2,\n  behavior: 'smooth',\n});\n"],"names":["form","input","galleryList","result","moreButton","BASE_URL","createToggle","selector","loader","loadText","resultText","moreBtn","currentPage","totalHits","per_page","currentQuery","event","iziToast","fetchImages","page","response","axios","totalPages","displayImages","error","message","images","clearValue","imagesMarkup","makeImgItem","lightbox","SimpleLightbox","webformatURL","tags","downloads","likes","comments","views","galleryItemHeight"],"mappings":"kDAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAQ,SAAS,cAAc,QAAQ,EACvCC,EAAc,SAAS,cAAc,eAAe,EACpDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAa,SAAS,cAAc,WAAW,EAC/CC,EAAW,2BAGXC,EAAeC,IAAa,CAChC,OAAQ,IAAM,SAAS,cAAcA,CAAQ,EAAE,UAAU,OAAO,UAAU,EAC1E,QAAS,IAAM,SAAS,cAAcA,CAAQ,EAAE,UAAU,IAAI,UAAU,CAC1E,GAEMC,EAASF,EAAa,OAAO,EAC7BG,EAAWH,EAAa,eAAe,EACvCI,EAAaJ,EAAa,cAAc,EACxCK,EAAUL,EAAa,WAAW,EAExC,IAAIM,EAAc,EACdC,EAAY,EACZC,EAAW,GACXC,EAAe,GAEnBf,EAAK,iBAAiB,SAAUgB,GAAS,CAGvC,GAFAA,EAAM,eAAc,EACpBD,EAAed,EAAM,MAAM,OACvBc,IAAiB,IAAMd,EAAM,QAAU,IAAK,CAC9CgB,EAAS,QAAQ,CACf,QAAS,8BACT,SAAU,WACV,gBAAiB,UACjB,aAAc,MACpB,CAAK,EACD,MACD,CACDF,EAAed,EAAM,MACrBW,EAAc,EACdM,EAAYH,EAAcH,CAAW,EACrCT,EAAO,YAAcY,CACvB,CAAC,EAEDX,EAAW,iBAAiB,QAAS,IAAM,CACzCQ,GAAe,EACfM,EAAYH,EAAcH,CAAW,EACrCT,EAAO,YAAcY,CACvB,CAAC,EAED,eAAeG,EAAYH,EAAcI,EAAM,CAC7CX,EAAO,OAAM,EACbC,EAAS,OAAM,EACXU,IAAS,IACXjB,EAAY,UAAY,IAE1B,GAAI,CACF,MAAMkB,EAAW,MAAMC,EAAM,IAAIhB,EAAU,CACzC,OAAQ,CACN,IAAK,qCACL,EAAGU,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAAI,EACA,SAAAL,CACD,CACP,CAAK,EAEKQ,EAAa,KAAK,KAAKF,EAAS,KAAK,UAAYN,CAAQ,EAC/D,OAAIM,EAAS,KAAK,MAChBP,EAAYO,EAAS,KAAK,UAC1BG,EAAcH,EAAS,KAAK,IAAI,EAChCZ,EAAO,QAAO,EACdC,EAAS,QAAO,EAChBC,EAAW,OAAM,EAEjBE,EAAcO,GACLA,EAAOG,GAChBX,EAAQ,QAAO,EACfF,EAAS,QAAO,EAChBD,EAAO,QAAO,EACdS,EAAS,QAAQ,CACf,SAAU,WACV,QAAS,4DACjB,CAAO,IAEDN,EAAQ,QAAO,EACfM,EAAS,QAAQ,CACf,QACE,2EACF,gBAAiB,UACjB,aAAc,MACtB,CAAO,GAEIG,EAAS,IACjB,OAAQI,EAAO,CACd,MAAAhB,EAAO,QAAO,EACdC,EAAS,QAAO,EAChBE,EAAQ,QAAO,EACf,QAAQ,MAAMa,CAAK,EACnBP,EAAS,QAAQ,CACf,QAAS,4DACf,CAAK,EACKO,CACP,CACH,CAEA,MAAMC,EACJ,2EAEF,SAASF,EAAcG,EAAQP,EAAM,CAOnC,GANIA,IAAS,IACXjB,EAAY,UAAY,IAEtBW,EAAYa,EAAO,QACrBf,EAAQ,OAAM,EAEZe,EAAO,SAAW,EAAG,CACvBlB,EAAO,QAAO,EACdC,EAAS,QAAO,EAChBC,EAAW,QAAO,EAClBC,EAAQ,QAAO,EAEfM,EAAS,QAAQ,CACf,QAASQ,EACT,gBAAiB,UACjB,aAAc,OACd,SAAU,WACV,QAAS,GACf,CAAK,EACD,WAAWE,EAAY,GAAI,EAE3B,MACD,CACD,MAAMC,EAAeF,EAAO,IAAIG,CAAW,EAAE,KAAK,EAAE,EACpD3B,EAAY,mBAAmB,YAAa0B,CAAY,EACxD,WAAWD,EAAY,GAAG,EAI1BG,EAAS,QAAO,CAClB,CAEA,SAASH,GAAa,CACpB1B,EAAM,MAAQ,EAChB,CAEA,MAAM6B,EAAW,IAAIC,EAAe,kBAAmB,CACrD,SAAU,GACV,aAAc,MACd,aAAc,IACd,MAAO,GACP,UAAW,wBACX,cAAe,EACf,WAAY,GACZ,QAAS,EACX,CAAC,EAED,SAASF,EAAY,CACnB,aAAAG,EACA,KAAAC,EACA,UAAAC,EACA,MAAAC,EACA,SAAAC,EACA,MAAAC,CACF,EAAG,CACD,MAAO;AAAA;AAAA;AAAA,mBAGUL,CAAY,kBAAkBA,CAAY;AAAA,sBACvCA,CAAY,UAAUC,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBAO7BE,CAAK;AAAA;AAAA;AAAA;AAAA,mBAILE,CAAK;AAAA;AAAA;AAAA;AAAA,iBAIPD,CAAQ;AAAA;AAAA;AAAA;AAAA,mBAINF,CAAS;AAAA;AAAA;AAAA;AAAA;AAAA,QAM5B,CAEA,MAAMI,EAAoB,SACvB,cAAc,eAAe,EAC7B,sBAAqB,EAAG,OAC3B,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QACZ,CAAC"}